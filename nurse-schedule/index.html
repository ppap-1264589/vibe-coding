<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lập lịch làm việc của y tá</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
  <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-lg">
    <h1 class="text-2xl font-bold mb-3 text-center text-blue-600">
      💊 Bài toán lập lịch làm việc của y tá
    </h1>

    <details class="mb-4">
      <summary class="cursor-pointer font-semibold text-gray-700 hover:text-blue-600">
        📘 Mô tả đề bài (click để xem)
      </summary>
      <div class="mt-2 text-gray-700 text-sm leading-relaxed">
        Một nhân viên y tá chỉ có thể làm việc liên tiếp tối thiểu là <code>k₁</code> ngày 
        và tối đa là <code>k₂</code> ngày trong giai đoạn <code>n</code> ngày.  
        Giữa hai đợt làm việc liên tiếp, cô ấy chỉ được nghỉ đúng 1 ngày (không được nghỉ nhiều hơn).  
        <br><br>
        <b>Nhiệm vụ:</b> Đếm số cách lập lịch thỏa mãn điều kiện trên.  
        <br>
        <b>Đầu vào:</b> <code>n</code>, <code>k₁</code>, <code>k₂</code>  
        <br>
        <b>Đầu ra:</b> Số cách hợp lệ (mod 1e9 + 7)
      </div>
    </details>

    <div class="space-y-3">
      <div>
        <label class="block font-semibold text-gray-700">Nhập n (≤ 100000):</label>
        <input id="n" type="number" class="w-full border p-2 rounded" oninput="limitInput('n', 100000)">
        <p id="warn-n" class="hidden text-red-600 text-sm">⚠️ n không được vượt quá 100000</p>
      </div>

      <div>
        <label class="block font-semibold text-gray-700">Nhập k₁ (≤ 10000):</label>
        <input id="k1" type="number" class="w-full border p-2 rounded" oninput="limitInput('k1', 10000)">
        <p id="warn-k1" class="hidden text-red-600 text-sm">⚠️ k₁ không được vượt quá 10000</p>
      </div>

      <div>
        <label class="block font-semibold text-gray-700">Nhập k₂ (≤ 10000):</label>
        <input id="k2" type="number" class="w-full border p-2 rounded" oninput="limitInput('k2', 10000)">
        <p id="warn-k2" class="hidden text-red-600 text-sm">⚠️ k₂ không được vượt quá 10000</p>
      </div>
    </div>

    <button onclick="solve()" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all">
      Tính số cách
    </button>

    <div id="result" class="mt-5 text-center text-lg font-semibold text-green-700"></div>
  </div>

  <script>
    const MOD = 1e9 + 7;

    function limitInput(id, maxValue) {
      const el = document.getElementById(id);
      const warn = document.getElementById("warn-" + id);
      let val = Number(el.value);

      if (val > maxValue) {
        el.value = maxValue;
        warn.classList.remove("hidden");
        el.classList.add("border-red-500", "animate-pulse");
        setTimeout(() => {
          warn.classList.add("hidden");
          el.classList.remove("border-red-500", "animate-pulse");
        }, 1500);
      }
    }

    function add(a, b) {
      a += b;
      if (a >= MOD) a -= MOD;
      return a;
    }

    function sub(a, b) {
      a -= b;
      if (a < 0) a += MOD;
      return a;
    }

    function solve() {
      const n = Number(document.getElementById("n").value);
      const k1 = Number(document.getElementById("k1").value);
      const k2 = Number(document.getElementById("k2").value);
      const resEl = document.getElementById("result");

      if (!n || !k1 || !k2 || k1 > k2 || n <= 0) {
        resEl.textContent = "⚠️ Dữ liệu không hợp lệ!";
        resEl.className = "mt-5 text-center text-lg font-semibold text-red-600";
        return;
      }

      let dp = new Array(k2 + 2).fill(0);
      dp[0] = 1; // nghỉ
      dp[1] = 1; // làm ngày đầu
      let restLoad = 0;

      for (let p = k1; p <= k2; p++) restLoad = add(restLoad, dp[p]);

      for (let i = 2; i <= n; i++) {
        let curLoad = sub(restLoad, dp[k2]);
        curLoad = add(curLoad, dp[k1 - 1]);

        dp.unshift(restLoad);
        dp.pop();

        restLoad = curLoad;
      }

      let ans = (dp[0] + restLoad) % MOD;
      resEl.textContent = `✅ Kết quả: ${ans.toLocaleString('vi-VN')}`;
      resEl.className = "mt-5 text-center text-lg font-semibold text-green-700";
    }
  </script>
</body>
</html>
